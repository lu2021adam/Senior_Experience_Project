knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, fig.height = 3, fig.width = 6)
library(tidyverse)
library(knitr)
library(dplyr)
library(corrplot)
library(skimr)
library(grid)
library(gridExtra)
library(tidyselect)
library(selectr)
library(ISLR)
library(forcats)
library(corrplot)
library(MASS)
library(ggplot2)
library(kableExtra)
library(caret)
library(grid)
library(openintro)
library(tidyverse)
library(ISLR)
library(caret)
library(recipes)
library(glmnet)
library(gam)
library(splines)
library(earth)
library(rpart)
library(rpart.plot)
library(ipred)
library(e1071)
library(ranger)
library(pls)
library(datasets)
library(DescTools)
library(Hmisc)
library(e1071)
library(pwr)
library(gapminder)
library(car)
library(tibble)
library(onewaytests)
library(rptR)
library(esc)
library(broom)
library(MASS)
library(corrgram)
library(rcompanion)
library(FSA)
library(lmtest)
library(lme4)
library(lmerTest)
library(Hmisc)
library(nlme)
library(GGally)
library(factoextra)
library(ISLR)
library(cluster) # for gower similarity and pam
set.seed(09042022)
CAYMAN_FISH <- read_csv("~/Desktop/IS_CAPSTONE/SINGLE_CAYMAN_FISH_DATA.csv")
CAYMAN_FISH_TIDY <- CAYMAN_FISH %>%
pivot_longer(cols = c("1998/CH", "1998/DG", "1998/SB", "1998/SC", "1998/TF", "2000/CP", "2000/DG",	"2000/SC",	"2000/CH",	"2000/SB",	"2000/TF",	"2000/SV",	"2000/BB",	"2002/BB",	"2002/DG",	"2002/SB",	"2002/SC",	"2002/SV",	"2002/CP",	"2002/TF",	"2004/CP",	"2004/DG",	"2004/SC",	"2004/SB",	"2004/HM",	"2004/SV",	"2004/BB",	"2006/CR",	"2006/DG",	"2006/CP",	"2006/SB",	"2006/SC",	"2006/SH",	"2006/SV",	"2006/TF",	"2008/BB",	"2008/CP",	"2008/CR",	"2008/DG",	"2008/SC",	"2008/SH",	"2008/SV",	"2008/TF",	"2010/CP",	"2010/CR",	"2010/DG",	"2010/HM",	"2010/SB",	"2010/SC",	"2010/SH",	"2010/SV",	"2010/TF",	"2012/BB",	"2012/CP",	"2012/CR",	"2012/DG",	"2012/ER",	"2012/SV",	"2012/SC",	"2012/SB",	"2012/SH",	"2012/TF",	"2014/BB",	"2014/CP",	"2014/CR",	"2014/CH",	"2014/DG",	"2014/SV",	"2014/SC",	"2014/SB",	"2014/SH",	"2014/TF",	"2016/SC",	"2016/DG",	"2016/CR",	"2016/SH",	"2016/SV",	"2016/CP",	"2016/TF",	"2016/CH",	"2016/SB",	"2016/ER",	"2018/BB",	"2018/CP",	"2018/CR",	"2018/DG",	"2018/ER",	"2018/SV",	"2018/SC",	"2018/SB",	"2018/SH",	"2018/TF"),
names_to = "YEAR/LOCATION", values_to = "DENSITY_INDEX") %>%
separate(col = "YEAR/LOCATION", into = c("YEAR", "LOCATION"), sep = "/")
CAYMAN_FISH_TIDY$YEAR <- as.numeric(CAYMAN_FISH_TIDY$YEAR)
CAYMAN_FISH_TIDY <- CAYMAN_FISH_TIDY[!(CAYMAN_FISH_TIDY$DENSITY_INDEX >= 4.0),]
CAYMAN_FISH_TIDY <- CAYMAN_FISH_TIDY %>% mutate(DEPTH = if_else(LOCATION %in% c("SC", "SV", "CP", "SB", "BB", "SH", "DG", "CR", "TF"), "Deep", "Shallow"))
### MAIN FAMILIES USED!
# Apogonidae = c("Barred Cardinalfish", "Belted Cardinalfish", "Flamefish", "Twospot Cardinalfish", "Whitestar Cardinalfish", "Sponge Cardinalfish")
# Carangidae = c("Blue Runner", "Bar Jack", "Horse-eye Jack", "Rainbow Runner", "Greater Amberjack", "Yellow Jack", "Almaco Jack", "Crevalle Jack", "Permit", "Black Jack", "Palometa", "Round Scad" )
# Sparidae = c("Jolthead Porgy", "Sheepshead Porgy", "Saucereye Porgy", "Pluma", "Spottail Pinfish", "Sheepshead", "Silver Porgy")
# Gobiidae = c("Shortstripe Goby", "Cleaning Goby", "Goldspot Goby", "Yellowline Goby", "Masked/Glass Goby", "Bridled Goby", "Neon Goby", "Colon Goby", "Blue Goby", "Spotlight Goby", "Peppermint Goby", "Yellownose Goby", "Sharknose Goby", "Pallid Goby", "Hovering Goby", "Rusty Goby", "Yellowprow Goby", "Orangesided Goby")
# Haemulidae = c("French Grunt", "Margate (White)", "Cottonwick", "Bluestriped Grunt", "Sailors Choice", "White Grunt", "Margate (Black)", "Porkfish", "Caesar Grunt", "Striped Grunt", "Boga", "Unidentified juvenile Grunt", "Smallmouth Grunt", "Tomtate", "Bonnetmouth", "Spanish Grunt")
# Lutjanidae = c("Mutton Snapper", "Schoolmaster", "Mahogany Snapper", "Yellowtail Snapper", "Lane Snapper", "Gray Snapper", "Dog Snapper", "Cubera Snapper", "Blackfin Snapper", "Glasseye Snapper")
# Pomacentridae = c("Threespot Damselfish", "Rock Beauty", "Blue Chromis", "Sergeant Major", "Longfin Damselfish", "Dusky Damselfish", "Sunshinefish", "Bicolor Damselfish", "Yellowtail Damselfish", "Brown Chromis", "Yellowtail Reeffish", "Cocoa Damselfish", "Beaugregory", "Purple Reeffish")
# Scaridae = c("Stoplight Parrotfish", "Redband Parrotfish", "Rainbow Parrotfish", "Princess Parrotfish", "Redtail Parrotfish", "Midnight Parrotfish", "Yellowtail (Redfin)Parrotfish", "Striped Parrotfish", "Queen Parrotfish", "Greenblotch Parrotfish", "Blue Parrotfish", "Bluelip Parrotfish", "Bucktooth Parrotfish")
# Serranidae = c("Red Hind", "Graysby", "Red Grouper", "Scamp", "Greater Soapfish", "Indigo Hamlet", "Shy Hamlet", "Barred Hamlet", "Nassau Grouper", "Black Grouper", "Butter Hamlet", "Lantern Bass", "Rock Hind", "Tiger Grouper", "Gag", "Harlequin Bass", "Coney", "Blue Hamlet", "Black Hamlet", "Yellowmouth Grouper", "Yellowtail Hamlet", "Goliath Grouper (Jewfish)", "Yellowfin Grouper", "Chalk Bass", "Yellowbelly Hamlet", "Hybrid Hamlet", "Tan Hamlet", "Belted Sandfish", "Creole-fish", "Peppermint Bass	")
# Labridae = c("Creole Wrasse", "Bluehead", "Spanish Hogfish", "Spotfin Hogfish", "Yellowhead Wrasse", "Blackear Wrasse","Puddingwife", "Hogfish", "Green Razorfish", "Slippery Dick", "Clown Wrasse", "Rainbow Wrasse", "Rosy Razorfish", "Yellowcheek Wrasse", "Pearly Razorfish")
# Holocentridae = c("Reef Squirrelfish", "Squirrelfish", "Longjaw Squirrelfish", "Longspine Squirrelfish", "Dusky Squirrelfish", "Blackbar Soldierfish")
# Other = c("Unidentified Triplefin", "Bonefish", "Flying Gurnard", "Bluespotted Cornetfish", "Sharptail Eel", "Houndfish", "Tobaccofish", "Atlantic Spadefish", "Arrow Blenny", "Secretary Blenny", "Sailfin Blenny", "Redspotted Hawkfish", "Sharksucker", "Silversides", "Nurse Shark", "Spotted Eagle Ray", "Glassy Sweeper", "Sand Diver", "Southern Stingray", "Yellow Stingray", "Yellowhead Jawfish", "Common Snook", "Yellowfin Mojarra", "Lancer Dragonet", "Tarpon", "Sand Tilefish", "Trumpetfish", "Brown Garden Eel", "Cubbyu", "Jackknife Fish", "Highhat", "Spotted Drum", "Smooth Trunkfish", "Spotted Trunkfish", "Scrawled Cowfish", "Honeycomb Cowfish", "Blue Tang", "Doctorfish", "Ocean Surgeonfish", "Green Sea Turtle", "Hawksbill Sea Turtle", "Unidentified Sea Turtle", "Loggerhead Sea Turtle", "Diamond Blenny", "Saddled Blenny", "Rosy Blenny", "Hairy Blenny", "Green Moray", "Goldentail Moray", "Spotted Moray", "Chain Moray", "Fairy Basslet", "Blackcap Basslet", "Threeline Basslet", "Lionfish", "Spotted Scorpionfish", "Sharpnose Puffer", "Bandtail Puffer", "Chub (Bermuda/Yellow)", "Balloonfish", "Porcupinefish", "Cero", "Spanish Mackerel", "Yellow Goatfish", "Spotted Goatfish", "Great Barracuda", "Southern Sennet", "Peacock Flounder", "Eyed Flounder", "Mottled Mojarra", "Reef Croaker", "Roughhead Blenny", "Sand Perch", "Spiny Blenny", "Molly Miller", "Redlip Blenny", "Darkheaded Blenny", "Pearl Blenny", "Wrasse Bleny", "Seaweed Blenny", "Queen Triggerfish", "Black Durgon", "Ocean Triggerfish", "Gray Triggerfish", "Sargassum Triggerfish", "French Angelfish", "Queen Angelfish", "Gray Angelfish", "Blue Angelfish", "Cherubfish", "Orangespotted Filefish", "Slender Filefish", "Scrawled Filefish", "Whitespotted Filefish", "Spotfin Butterflyfish", "Foureye Butterflyfish", "Banded Butterflyfish", "Longsnout Butterflyfish", "Reel Butterflyfish")
# OTHER FAMILIES INCLUDE
# Albulidae = c("Bonefish")
# Dactylopteridae = c("Flying Gurnard")
# Fistulariidae = c("Bluespotted Cornetfish")
# Ophichthidae = c("Sharptail Eel")
# Belonidae = c("Houndfish")
# Grammidae = c("Tobaccofish")
# Ephippidae = c("Atlantic Spadefish")
# Chaenopsidae = c("Arrow Blenny", "Secretary Blenny", "Sailfin Blenny")
# Cirrhitidae = c("Redspotted Hawkfish")
# Echeneidae = c("Sharksucker")
# Atherinidae = c("Silversides")
# Ginglymostomatidae = c("Nurse Shark")
# Myliobatidae = c("Spotted Eagle Ray")
# Pempheridae = c("Glassy Sweeper")
# Synodontidae = c("Sand Diver")
# Dasyatidae = c("Southern Stingray")
# Urotrygonidae = c("Yellow Stingray")
# Opistognathidae = c("Yellowhead Jawfish")
# Centropomidae = c("Common Snook")
# Gerreidae = c("Yellowfin Mojarra")
# Callionymidae = c("Lancer Dragonet")
# Megalopidae = c("Tarpon")
# Malacanthidae = c("Sand Tilefish")
# Aulostomidae = c("Trumpetfish")
# Congridae = c("Brown Garden Eel")
# Sciaenidae = c("Cubbyu", "Jackknife Fish", "Highhat", "Spotted Drum")
# Ostraciidae = c("Smooth Trunkfish", "Spotted Trunkfish", "Scrawled Cowfish", "Honeycomb Cowfish" )
# Acantharidae = c("Blue Tang", "Doctorfish", "Ocean Surgeonfish")
# Cheloniidae = c("Green Sea Turtle", "Hawksbill Sea Turtle", "Unidentified Sea Turtle", "Loggerhead Sea Turtle")
# Labrisomidae = c("Diamond Blenny", "Saddled Blenny", "Rosy Blenny", "Hairy Blenny")
# Muraenidae = c("Green Moray", "Goldentail Moray", "Spotted Moray", "Chain Moray")
# Grammatidae = c("Fairy Basslet", "Blackcap Basslet", "Threeline Basslet")
# Scorpaenidae = c("Lionfish", "Spotted Scorpionfish")
# Tetraodontidae = c("Sharpnose Puffer", "Bandtail Puffer")
# Kyphosidae = c("Chub (Bermuda/Yellow)")
# Diodontidae = c("Balloonfish", "Porcupinefish")
# Scombridae = c("Cero", "Spanish Mackerel")
# Mullidae = c("Yellow Goatfish", "Spotted Goatfish")
# Sphyraenidae = c("Great Barracuda", "Southern Sennet")
# Bothidae = c("Peacock Flounder", "Eyed Flounder")
# Blenniidae = c("Molly Miller", "Redlip Blenny", "Darkheaded Blenny", "Pearl Blenny", "Wrasse Bleny", "Seaweed Blenny")
# Balistidae = c("Queen Triggerfish", "Black Durgon", "Ocean Triggerfish", "Gray Triggerfish", "Sargassum Triggerfish")
# Pomacanthidae = c("French Angelfish", "Queen Angelfish", "Gray Angelfish", "Blue Angelfish", "Cherubfish")
# Monacanthidae = c("Orangespotted Filefish", "Slender Filefish", "Scrawled Filefish", "Whitespotted Filefish")
# Chaetodontidae = c("Spotfin Butterflyfish", "Foureye Butterflyfish", "Banded Butterflyfish", "Longsnout Butterflyfish", "Reel Butterflyfish")
CAYMAN_FISH_TIDY <- CAYMAN_FISH_TIDY %>% mutate(SCIENTIFIC_FAMILY = c("0"))
CAYMAN_FISH_TIDY <- CAYMAN_FISH_TIDY %>% mutate(SCIENTIFIC_FAMILY = case_when(
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Barred Cardinalfish", "Belted Cardinalfish", "Flamefish", "Twospot Cardinalfish", "Whitestar Cardinalfish", "Sponge Cardinalfish") ~ "Apogonidae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Blue Runner", "Bar Jack", "Horse-eye Jack", "Rainbow Runner", "Greater Amberjack", "Yellow Jack", "Almaco Jack", "Crevalle Jack", "Permit", "Black Jack", "Palometa", "Round Scad") ~ "Carangidae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Jolthead Porgy", "Sheepshead Porgy", "Saucereye Porgy", "Pluma", "Spottail Pinfish", "Sheepshead", "Silver Porgy") ~ "Sparidae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Shortstripe Goby", "Cleaning Goby", "Goldspot Goby", "Yellowline Goby", "Masked/Glass Goby", "Bridled Goby", "Neon Goby", "Colon Goby", "Blue Goby", "Spotlight Goby", "Peppermint Goby", "Yellownose Goby", "Sharknose Goby", "Pallid Goby", "Hovering Goby", "Rusty Goby", "Yellowprow Goby", "Orangesided Goby") ~ "Gobiidae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("French Grunt", "Margate (White)", "Cottonwick", "Bluestriped Grunt", "Sailors Choice", "White Grunt", "Margate (Black)", "Porkfish", "Caesar Grunt", "Striped Grunt", "Boga", "Unidentified juvenile Grunt", "Smallmouth Grunt", "Tomtate", "Bonnetmouth", "Spanish Grunt") ~ "Haemulidae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Mutton Snapper", "Schoolmaster", "Mahogany Snapper", "Yellowtail Snapper", "Lane Snapper", "Gray Snapper", "Dog Snapper", "Cubera Snapper", "Blackfin Snapper", "Glasseye Snapper") ~ "Lutjanidae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Threespot Damselfish", "Rock Beauty", "Blue Chromis", "Sergeant Major", "Longfin Damselfish", "Dusky Damselfish", "Sunshinefish", "Bicolor Damselfish", "Yellowtail Damselfish", "Brown Chromis", "Yellowtail Reeffish", "Cocoa Damselfish", "Beaugregory", "Purple Reeffish") ~ "Pomacentridae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Stoplight Parrotfish", "Redband Parrotfish", "Rainbow Parrotfish", "Princess Parrotfish", "Redtail Parrotfish", "Midnight Parrotfish", "Yellowtail (Redfin)Parrotfish", "Striped Parrotfish", "Queen Parrotfish", "Greenblotch Parrotfish", "Blue Parrotfish", "Bluelip Parrotfish", "Bucktooth Parrotfish") ~ "Scaridae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Red Hind", "Graysby", "Red Grouper", "Scamp", "Greater Soapfish", "Indigo Hamlet", "Shy Hamlet", "Barred Hamlet", "Nassau Grouper", "Black Grouper", "Butter Hamlet", "Lantern Bass", "Rock Hind", "Tiger Grouper", "Gag", "Harlequin Bass", "Coney", "Blue Hamlet", "Black Hamlet", "Yellowmouth Grouper", "Yellowtail Hamlet", "Goliath Grouper (Jewfish)", "Yellowfin Grouper", "Chalk Bass", "Yellowbelly Hamlet", "Hybrid Hamlet", "Tan Hamlet", "Belted Sandfish", "Creole-fish", "Peppermint Bass") ~ "Serranidae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Creole Wrasse", "Bluehead", "Spanish Hogfish", "Spotfin Hogfish", "Yellowhead Wrasse", "Blackear Wrasse","Puddingwife", "Hogfish", "Green Razorfish", "Slippery Dick", "Clown Wrasse", "Rainbow Wrasse", "Rosy Razorfish", "Yellowcheek Wrasse", "Pearly Razorfish") ~ "Labridae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Reef Squirrelfish", "Squirrelfish", "Longjaw Squirrelfish", "Longspine Squirrelfish", "Dusky Squirrelfish", "Blackbar Soldierfish") ~ "Holocentridae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Unidentified Triplefin", "Bonefish", "Flying Gurnard", "Bluespotted Cornetfish", "Sharptail Eel", "Houndfish", "Tobaccofish", "Atlantic Spadefish", "Arrow Blenny", "Secretary Blenny", "Sailfin Blenny", "Redspotted Hawkfish", "Sharksucker", "Silversides", "Nurse Shark", "Spotted Eagle Ray", "Glassy Sweeper", "Sand Diver", "Southern Stingray", "Yellow Stingray", "Yellowhead Jawfish", "Common Snook", "Yellowfin Mojarra", "Lancer Dragonet", "Tarpon", "Sand Tilefish", "Trumpetfish", "Brown Garden Eel", "Cubbyu", "Jackknife Fish", "Highhat", "Spotted Drum", "Smooth Trunkfish", "Spotted Trunkfish", "Scrawled Cowfish", "Honeycomb Cowfish", "Blue Tang", "Doctorfish", "Ocean Surgeonfish", "Green Sea Turtle", "Hawksbill Sea Turtle", "Unidentified Sea Turtle", "Loggerhead Sea Turtle", "Diamond Blenny", "Saddled Blenny", "Rosy Blenny", "Hairy Blenny", "Green Moray", "Goldentail Moray", "Spotted Moray", "Chain Moray", "Fairy Basslet", "Blackcap Basslet", "Threeline Basslet", "Lionfish", "Spotted Scorpionfish", "Sharpnose Puffer", "Bandtail Puffer", "Chub (Bermuda/Yellow)", "Balloonfish", "Porcupinefish", "Cero", "Spanish Mackerel", "Yellow Goatfish", "Spotted Goatfish", "Great Barracuda", "Southern Sennet", "Peacock Flounder", "Eyed Flounder", "Mottled Mojarra", "Reef Croaker", "Roughhead Blenny", "Sand Perch", "Spiny Blenny", "Molly Miller", "Redlip Blenny", "Darkheaded Blenny", "Pearl Blenny", "Wrasse Bleny", "Seaweed Blenny", "Queen Triggerfish", "Black Durgon", "Ocean Triggerfish", "Gray Triggerfish", "Sargassum Triggerfish", "French Angelfish", "Queen Angelfish", "Gray Angelfish", "Blue Angelfish", "Cherubfish", "Orangespotted Filefish", "Slender Filefish", "Scrawled Filefish", "Whitespotted Filefish", "Spotfin Butterflyfish", "Foureye Butterflyfish", "Banded Butterflyfish", "Longsnout Butterflyfish", "Reel Butterflyfish") ~ "Other",
TRUE ~ as.character(CAYMAN_FISH_TIDY$SCIENTIFIC_FAMILY)
))
### Contingency Table/Proportion Table
Compare_Location_Families <- table(CAYMAN_FISH_TIDY$LOCATION, CAYMAN_FISH_TIDY$SCIENTIFIC_FAMILY)
Proportions_Location_Families <- prop.table(Compare_Location_Families, margin= NULL)
Proportions_Location_Families
# The biggest test that is associated with these contingency tables is the chi-square test. This is a test of independence of variables. The whole of the test is explained in a section below, but for now just understanding that the test will tell you if two variables are independent is key.
# When running this code the table turns into decimal proportion values. The function prop.table is used to create these tables. First, the table is named and then assigned to the prop.table being created. Taking the COMPARE_CHARACTER contingency table, the computer knows to change this data into proportions of the whole as decimals. ALWAYS SET MARGIN=NULL or else the code will not work for instances like this. In the actual chart, the data is displayed as a proportion of the whole. It takes the values within each location for a specific family of fish and divides them by the total observations in the dataset to get a proportion. For instance, at CP, the value for Serranidae is 0.0133079005. This means that of the 22543 observations, 1.33% are from fish in the family Serranidae that are found at the CP site.
### SUMMARY BY FAMILY
CAYMAN_FISH_FAMILY <- CAYMAN_FISH_TIDY %>% group_by(SCIENTIFIC_FAMILY) %>% dplyr::summarize(MEAN = mean(DENSITY_INDEX), ST.DEV = sd(DENSITY_INDEX), ST.ERR = sd(DENSITY_INDEX)/sqrt(n()), N = n())
### 95% CI
Classification.Z.FAM<- qnorm(.025, lower.tail = FALSE)
# 95% CI interval mutated into the Classification Graph
Final.Classification.FAM<- CAYMAN_FISH_FAMILY %>% mutate (upper.95= MEAN +ST.ERR*Classification.Z.FAM, lower.95= MEAN - ST.ERR*Classification.Z.FAM)
CAYMAN_FISH_FAMILY <- CAYMAN_FISH_FAMILY %>% mutate(upper.95= MEAN +ST.ERR*Classification.Z.FAM, lower.95= MEAN - ST.ERR*Classification.Z.FAM)
# Check out the final product for the families
Final.Classification.FAM
# Graph it
# 95% CI FOR EACH Families MEAN DENSITY INDEX
# 95% CONFIDENCE INTERVAL INTERPRETATION: "we are 95% confident that the population parameter is between X and X."
ggplot(Final.Classification.FAM, aes(x= SCIENTIFIC_FAMILY, y=MEAN, color=SCIENTIFIC_FAMILY))+
geom_point(size= 3)+
geom_errorbar(aes(ymin= lower.95, ymax= upper.95), width=0.2)
#### Check Parametric Assumptions
### THREE ASSUMPTIONS
# 1. All sample observations must be independent of one another
# 2. Data are Normally Distributed
# 3. Homogeneity of of variance (equal variances): Levenes Test
### Homogeneity and Levenes Test
# NON-LOG TRANSFORMED
Levene_Family <- leveneTest(DENSITY_INDEX ~ SCIENTIFIC_FAMILY, data= CAYMAN_FISH_TIDY)
Levene_Family
#########  OVERALL FINDINGS!
# Assumptions for linear Modeling Clearly are violated
# Parametric  Statistics Violation
# Levene test P-Values < 2.2e-16 = REJECT the null hypothesis, Unequal Variance!
### KRUSKAL MEDIANS
# The Kruskal-Wallis H test (sometimes also called the "one-way ANOVA on ranks") is a rank-based nonparametric test that can be used to determine if there are statistically significant differences between two or more groups of an independent variable on a continuous or ordinal dependent variable.
# ASSUMPTIONS:
# Assumption #1: Your dependent variable should be measured at the ordinal or continuous level
# Assumption #2: Your independent variable should consist of two or more categorical, independent groups.
# Assumption #3: You should have independence of observations, which means that there is no relationship between the observations in each group or between the groups themselves.
# ASSUMPTION #4: In order to know how to interpret the results from a Kruskal-Wallis H test, you have to determine whether the distributions in each group (i.e., the distribution of scores for each group of the independent variable) have the same shape (which also means the same variability).
### Density Plot BY FAMILY
DENSITY_FAMILY <- ggplot(CAYMAN_FISH_TIDY, aes(x = DENSITY_INDEX, color = SCIENTIFIC_FAMILY, fill = SCIENTIFIC_FAMILY))+
geom_density(alpha = 0.1)+
xlab("DENSITY INDEX")+
ylab("Frequency")+
labs(title = "Density Index Distribution Across Scientific Families")
DENSITY_FAMILY
# DISTRIBUTIONS ARE NOT UNRESONABLY DISSIMILAR, A GOOD FINDING! PROCEED WITH TESTING
# NOTE THAT OTHER MAY BE SLIGHTLY IMPACTFUL ON TEST RESULTS...
Kruskal_Cayman_Families <- kruskal.test(DENSITY_INDEX ~ SCIENTIFIC_FAMILY, data=CAYMAN_FISH_TIDY)
Kruskal_Cayman_Families
# Reject the null, p-value = < 2.2e-16 medians are different between FAMILIES
### Visualization
ggplot(CAYMAN_FISH_TIDY, aes(x= SCIENTIFIC_FAMILY, y = DENSITY_INDEX, fill = SCIENTIFIC_FAMILY))+
geom_boxplot()+
xlab("Dive Site LOCATION")+
ylab("Density Index")
CAYMAN_NO_ZEROS <- CAYMAN_FISH_TIDY %>% filter(DENSITY_INDEX != 0)
View(CAYMAN_FISH_TIDY)
CAYMAN_FISH_CLUSTER <- CAYMAN_FISH_TIDY %>% dplyr::select(-DENSITY_INDEX, -SPECIES_NAME, -FISH_ID, -DEPTH)
CAYMAN_FISH_CLUSTER$YEAR <- as.factor(CAYMAN_FISH_CLUSTER$YEAR)
CAYMAN_FISH_CLUSTER$LOCATION <- as.factor(CAYMAN_FISH_CLUSTER$LOCATION)
CAYMAN_FISH_CLUSTER$SCIENTIFIC_FAMILY <- as.factor(CAYMAN_FISH_CLUSTER$SCIENTIFIC_FAMILY)
Cayman_Gower <- daisy(CAYMAN_FISH_CLUSTER,
metric = "gower")
gower_mat_cayman <- as.matrix(Cayman_Gower)
sil_width <- c(NA)
for(i in 2:10){
pam_fit <- pam(Cayman_Gower,
diss = TRUE,
k = i)
sil_width[i] <- pam_fit$silinfo$avg.width
}
