# 2. Data are Normally Distributed
# 3. Homogeneity of of variance (equal variances): Levenes Test
### Homogeneity and Levenes Test
# NON-LOG TRANSFORMED
Levene_Family <- leveneTest(DENSITY_INDEX ~ SCIENTIFIC_FAMILY, data= CAYMAN_FISH_TIDY)
Levene_Family
#########  OVERALL FINDINGS!
# Assumptions for linear Modeling Clearly are violated
# Parametric  Statistics Violation
# Levene test P-Values < 2.2e-16 = REJECT the null hypothesis, Unequal Variance!
### KRUSKAL MEDIANS
# The Kruskal-Wallis H test (sometimes also called the "one-way ANOVA on ranks") is a rank-based nonparametric test that can be used to determine if there are statistically significant differences between two or more groups of an independent variable on a continuous or ordinal dependent variable.
# ASSUMPTIONS:
# Assumption #1: Your dependent variable should be measured at the ordinal or continuous level
# Assumption #2: Your independent variable should consist of two or more categorical, independent groups.
# Assumption #3: You should have independence of observations, which means that there is no relationship between the observations in each group or between the groups themselves.
# ASSUMPTION #4: In order to know how to interpret the results from a Kruskal-Wallis H test, you have to determine whether the distributions in each group (i.e., the distribution of scores for each group of the independent variable) have the same shape (which also means the same variability).
### Density Plot BY FAMILY
DENSITY_FAMILY <- ggplot(CAYMAN_FISH_TIDY, aes(x = DENSITY_INDEX, color = SCIENTIFIC_FAMILY, fill = SCIENTIFIC_FAMILY))+
geom_density(alpha = 0.1)+
xlab("DENSITY INDEX")+
ylab("Frequency")+
labs(title = "Density Index Distribution Across Scientific Families")
DENSITY_FAMILY
# DISTRIBUTIONS ARE NOT UNRESONABLY DISSIMILAR, A GOOD FINDING! PROCEED WITH TESTING
# NOTE THAT OTHER MAY BE SLIGHTLY IMPACTFUL ON TEST RESULTS...
Kruskal_Cayman_Families <- kruskal.test(DENSITY_INDEX ~ SCIENTIFIC_FAMILY, data=CAYMAN_FISH_TIDY)
Kruskal_Cayman_Families
# Reject the null, p-value = < 2.2e-16 medians are different between FAMILIES
### Visualization
ggplot(CAYMAN_FISH_TIDY, aes(x= SCIENTIFIC_FAMILY, y = DENSITY_INDEX, fill = SCIENTIFIC_FAMILY))+
geom_boxplot()+
xlab("Dive Site LOCATION")+
ylab("Density Index")
CAYMAN_NO_ZEROS <- CAYMAN_FISH_TIDY %>% filter(DENSITY_INDEX != 0)
View(CAYMAN_FISH_TIDY)
CAYMAN_FISH_CLUSTER <- CAYMAN_FISH_TIDY %>% dplyr::select(-DENSITY_INDEX, -SPECIES_NAME, -FISH_ID, -DEPTH)
CAYMAN_FISH_CLUSTER$YEAR <- as.factor(CAYMAN_FISH_CLUSTER$YEAR)
CAYMAN_FISH_CLUSTER$LOCATION <- as.factor(CAYMAN_FISH_CLUSTER$LOCATION)
CAYMAN_FISH_CLUSTER$SCIENTIFIC_FAMILY <- as.factor(CAYMAN_FISH_CLUSTER$SCIENTIFIC_FAMILY)
Cayman_Gower <- daisy(CAYMAN_FISH_CLUSTER,
metric = "gower")
gower_mat_cayman <- as.matrix(Cayman_Gower)
sil_width <- c(NA)
for(i in 2:10){
pam_fit <- pam(Cayman_Gower,
diss = TRUE,
k = i)
sil_width[i] <- pam_fit$silinfo$avg.width
}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, fig.height = 5, fig.width = 6)
library(tidyverse)
library(knitr)
library(dplyr)
library(corrplot)
library(skimr)
library(grid)
library(gridExtra)
library(tidyselect)
library(selectr)
library(ISLR)
library(forcats)
library(corrplot)
library(ggplot2)
library(kableExtra)
library(caret)
library(grid)
library(openintro)
library(tidyverse)
library(ISLR)
library(caret)
library(recipes)
library(glmnet)
library(gam)
library(splines)
library(earth)
library(rpart)
library(rpart.plot)
library(ipred)
library(e1071)
library(ranger)
library(pls)
library(datasets)
library(DescTools)
library(Hmisc)
library(e1071)
library(pwr)
library(gapminder)
library(car)
library(tibble)
library(onewaytests)
library(rptR)
library(esc)
library(broom)
library(MASS)
library(corrgram)
library(rcompanion)
library(FSA)
library(lmtest)
library(lme4)
library(lmerTest)
library(Hmisc)
library(nlme)
library(GGally)
library(factoextra)
library(ISLR)
library(cluster) # for gower similarity and pam
library(Rtsne)
library(mixtools)
library(mclust)
library(lattice)
require(pscl) # alternatively can use package ZIM for zero-inflated models
set.seed(09042022)
CAYMAN_FISH <- read_csv("~/Desktop/IS_CAPSTONE/SINGLE_CAYMAN_FISH_DATA.csv")
CAYMAN_FISH_TIDY <- CAYMAN_FISH %>%
pivot_longer(cols = c("1998/CH", "1998/DG", "1998/SB", "1998/SC", "1998/TF", "2000/CP", "2000/DG",	"2000/SC",	"2000/CH",	"2000/SB",	"2000/TF",	"2000/SV",	"2000/BB",	"2002/BB",	"2002/DG",	"2002/SB",	"2002/SC",	"2002/SV",	"2002/CP",	"2002/TF",	"2004/CP",	"2004/DG",	"2004/SC",	"2004/SB",	"2004/HM",	"2004/SV",	"2004/BB",	"2006/CR",	"2006/DG",	"2006/CP",	"2006/SB",	"2006/SC",	"2006/SH",	"2006/SV",	"2006/TF",	"2008/BB",	"2008/CP",	"2008/CR",	"2008/DG",	"2008/SC",	"2008/SH",	"2008/SV",	"2008/TF",	"2010/CP",	"2010/CR",	"2010/DG",	"2010/HM",	"2010/SB",	"2010/SC",	"2010/SH",	"2010/SV",	"2010/TF",	"2012/BB",	"2012/CP",	"2012/CR",	"2012/DG",	"2012/ER",	"2012/SV",	"2012/SC",	"2012/SB",	"2012/SH",	"2012/TF",	"2014/BB",	"2014/CP",	"2014/CR",	"2014/CH",	"2014/DG",	"2014/SV",	"2014/SC",	"2014/SB",	"2014/SH",	"2014/TF",	"2016/SC",	"2016/DG",	"2016/CR",	"2016/SH",	"2016/SV",	"2016/CP",	"2016/TF",	"2016/CH",	"2016/SB",	"2016/ER",	"2018/BB",	"2018/CP",	"2018/CR",	"2018/DG",	"2018/ER",	"2018/SV",	"2018/SC",	"2018/SB",	"2018/SH",	"2018/TF"),
names_to = "YEAR/LOCATION", values_to = "DENSITY_INDEX") %>%
separate(col = "YEAR/LOCATION", into = c("YEAR", "LOCATION"), sep = "/")
CAYMAN_FISH_TIDY$YEAR <- as.numeric(CAYMAN_FISH_TIDY$YEAR)
CAYMAN_FISH_TIDY <- CAYMAN_FISH_TIDY[!(CAYMAN_FISH_TIDY$DENSITY_INDEX >= 4.0),]
CAYMAN_FISH_TIDY <- CAYMAN_FISH_TIDY[!(CAYMAN_FISH_TIDY$LOCATION == "HM"),]
CAYMAN_FISH_TIDY <- CAYMAN_FISH_TIDY %>% mutate(MARINE_RESERVE = if_else(LOCATION %in% c("BB", "SB", "TF", "SC"), "No", "Yes")) %>% dplyr::select(SPECIES_NAME, FISH_ID, YEAR, DIET, LOCATION, MARINE_RESERVE, DENSITY_INDEX)
### MAIN FAMILIES USED!
# Apogonidae = c("Barred Cardinalfish", "Belted Cardinalfish", "Flamefish", "Twospot Cardinalfish", "Whitestar Cardinalfish", "Sponge Cardinalfish")
# Carangidae = c("Blue Runner", "Bar Jack", "Horse-eye Jack", "Rainbow Runner", "Greater Amberjack", "Yellow Jack", "Almaco Jack", "Crevalle Jack", "Permit", "Black Jack", "Palometa", "Round Scad" )
# Sparidae = c("Jolthead Porgy", "Sheepshead Porgy", "Saucereye Porgy", "Pluma", "Spottail Pinfish", "Sheepshead", "Silver Porgy")
# Gobiidae = c("Shortstripe Goby", "Cleaning Goby", "Goldspot Goby", "Yellowline Goby", "Masked/Glass Goby", "Bridled Goby", "Neon Goby", "Colon Goby", "Blue Goby", "Spotlight Goby", "Peppermint Goby", "Yellownose Goby", "Sharknose Goby", "Pallid Goby", "Hovering Goby", "Rusty Goby", "Yellowprow Goby", "Orangesided Goby")
# Haemulidae = c("French Grunt", "Margate (White)", "Cottonwick", "Bluestriped Grunt", "Sailors Choice", "White Grunt", "Margate (Black)", "Porkfish", "Caesar Grunt", "Striped Grunt", "Boga", "Unidentified juvenile Grunt", "Smallmouth Grunt", "Tomtate", "Bonnetmouth", "Spanish Grunt")
# Lutjanidae = c("Mutton Snapper", "Schoolmaster", "Mahogany Snapper", "Yellowtail Snapper", "Lane Snapper", "Gray Snapper", "Dog Snapper", "Cubera Snapper", "Blackfin Snapper", "Glasseye Snapper")
# Pomacentridae = c("Threespot Damselfish", "Rock Beauty", "Blue Chromis", "Sergeant Major", "Longfin Damselfish", "Dusky Damselfish", "Sunshinefish", "Bicolor Damselfish", "Yellowtail Damselfish", "Brown Chromis", "Yellowtail Reeffish", "Cocoa Damselfish", "Beaugregory", "Purple Reeffish")
# Scaridae = c("Stoplight Parrotfish", "Redband Parrotfish", "Rainbow Parrotfish", "Princess Parrotfish", "Redtail Parrotfish", "Midnight Parrotfish", "Yellowtail (Redfin)Parrotfish", "Striped Parrotfish", "Queen Parrotfish", "Greenblotch Parrotfish", "Blue Parrotfish", "Bluelip Parrotfish", "Bucktooth Parrotfish")
# Serranidae = c("Red Hind", "Graysby", "Red Grouper", "Scamp", "Greater Soapfish", "Indigo Hamlet", "Shy Hamlet", "Barred Hamlet", "Nassau Grouper", "Black Grouper", "Butter Hamlet", "Lantern Bass", "Rock Hind", "Tiger Grouper", "Gag", "Harlequin Bass", "Coney", "Blue Hamlet", "Black Hamlet", "Yellowmouth Grouper", "Yellowtail Hamlet", "Goliath Grouper (Jewfish)", "Yellowfin Grouper", "Chalk Bass", "Yellowbelly Hamlet", "Hybrid Hamlet", "Tan Hamlet", "Belted Sandfish", "Creole-fish", "Peppermint Bass	")
# Labridae = c("Creole Wrasse", "Bluehead", "Spanish Hogfish", "Spotfin Hogfish", "Yellowhead Wrasse", "Blackear Wrasse","Puddingwife", "Hogfish", "Green Razorfish", "Slippery Dick", "Clown Wrasse", "Rainbow Wrasse", "Rosy Razorfish", "Yellowcheek Wrasse", "Pearly Razorfish")
# Holocentridae = c("Reef Squirrelfish", "Squirrelfish", "Longjaw Squirrelfish", "Longspine Squirrelfish", "Dusky Squirrelfish", "Blackbar Soldierfish")
# Other = c("Unidentified Triplefin", "Bonefish", "Flying Gurnard", "Bluespotted Cornetfish", "Sharptail Eel", "Houndfish", "Tobaccofish", "Atlantic Spadefish", "Arrow Blenny", "Secretary Blenny", "Sailfin Blenny", "Redspotted Hawkfish", "Sharksucker", "Silversides", "Nurse Shark", "Spotted Eagle Ray", "Glassy Sweeper", "Sand Diver", "Southern Stingray", "Yellow Stingray", "Yellowhead Jawfish", "Common Snook", "Yellowfin Mojarra", "Lancer Dragonet", "Tarpon", "Sand Tilefish", "Trumpetfish", "Brown Garden Eel", "Cubbyu", "Jackknife Fish", "Highhat", "Spotted Drum", "Smooth Trunkfish", "Spotted Trunkfish", "Scrawled Cowfish", "Honeycomb Cowfish", "Blue Tang", "Doctorfish", "Ocean Surgeonfish", "Green Sea Turtle", "Hawksbill Sea Turtle", "Unidentified Sea Turtle", "Loggerhead Sea Turtle", "Diamond Blenny", "Saddled Blenny", "Rosy Blenny", "Hairy Blenny", "Green Moray", "Goldentail Moray", "Spotted Moray", "Chain Moray", "Fairy Basslet", "Blackcap Basslet", "Threeline Basslet", "Lionfish", "Spotted Scorpionfish", "Sharpnose Puffer", "Bandtail Puffer", "Chub (Bermuda/Yellow)", "Balloonfish", "Porcupinefish", "Cero", "Spanish Mackerel", "Yellow Goatfish", "Spotted Goatfish", "Great Barracuda", "Southern Sennet", "Peacock Flounder", "Eyed Flounder", "Mottled Mojarra", "Reef Croaker", "Roughhead Blenny", "Sand Perch", "Spiny Blenny", "Molly Miller", "Redlip Blenny", "Darkheaded Blenny", "Pearl Blenny", "Wrasse Bleny", "Seaweed Blenny", "Queen Triggerfish", "Black Durgon", "Ocean Triggerfish", "Gray Triggerfish", "Sargassum Triggerfish", "French Angelfish", "Queen Angelfish", "Gray Angelfish", "Blue Angelfish", "Cherubfish", "Orangespotted Filefish", "Slender Filefish", "Scrawled Filefish", "Whitespotted Filefish", "Spotfin Butterflyfish", "Foureye Butterflyfish", "Banded Butterflyfish", "Longsnout Butterflyfish", "Reel Butterflyfish")
# OTHER FAMILIES INCLUDE
# Albulidae = c("Bonefish")
# Dactylopteridae = c("Flying Gurnard")
# Fistulariidae = c("Bluespotted Cornetfish")
# Ophichthidae = c("Sharptail Eel")
# Belonidae = c("Houndfish")
# Grammidae = c("Tobaccofish")
# Ephippidae = c("Atlantic Spadefish")
# Chaenopsidae = c("Arrow Blenny", "Secretary Blenny", "Sailfin Blenny")
# Cirrhitidae = c("Redspotted Hawkfish")
# Echeneidae = c("Sharksucker")
# Atherinidae = c("Silversides")
# Ginglymostomatidae = c("Nurse Shark")
# Myliobatidae = c("Spotted Eagle Ray")
# Pempheridae = c("Glassy Sweeper")
# Synodontidae = c("Sand Diver")
# Dasyatidae = c("Southern Stingray")
# Urotrygonidae = c("Yellow Stingray")
# Opistognathidae = c("Yellowhead Jawfish")
# Centropomidae = c("Common Snook")
# Gerreidae = c("Yellowfin Mojarra")
# Callionymidae = c("Lancer Dragonet")
# Megalopidae = c("Tarpon")
# Malacanthidae = c("Sand Tilefish")
# Aulostomidae = c("Trumpetfish")
# Congridae = c("Brown Garden Eel")
# Sciaenidae = c("Cubbyu", "Jackknife Fish", "Highhat", "Spotted Drum")
# Ostraciidae = c("Smooth Trunkfish", "Spotted Trunkfish", "Scrawled Cowfish", "Honeycomb Cowfish" )
# Acantharidae = c("Blue Tang", "Doctorfish", "Ocean Surgeonfish")
# Cheloniidae = c("Green Sea Turtle", "Hawksbill Sea Turtle", "Unidentified Sea Turtle", "Loggerhead Sea Turtle")
# Labrisomidae = c("Diamond Blenny", "Saddled Blenny", "Rosy Blenny", "Hairy Blenny")
# Muraenidae = c("Green Moray", "Goldentail Moray", "Spotted Moray", "Chain Moray")
# Grammatidae = c("Fairy Basslet", "Blackcap Basslet", "Threeline Basslet")
# Scorpaenidae = c("Lionfish", "Spotted Scorpionfish")
# Tetraodontidae = c("Sharpnose Puffer", "Bandtail Puffer")
# Kyphosidae = c("Chub (Bermuda/Yellow)")
# Diodontidae = c("Balloonfish", "Porcupinefish")
# Scombridae = c("Cero", "Spanish Mackerel")
# Mullidae = c("Yellow Goatfish", "Spotted Goatfish")
# Sphyraenidae = c("Great Barracuda", "Southern Sennet")
# Bothidae = c("Peacock Flounder", "Eyed Flounder")
# Blenniidae = c("Molly Miller", "Redlip Blenny", "Darkheaded Blenny", "Pearl Blenny", "Wrasse Bleny", "Seaweed Blenny")
# Balistidae = c("Queen Triggerfish", "Black Durgon", "Ocean Triggerfish", "Gray Triggerfish", "Sargassum Triggerfish")
# Pomacanthidae = c("French Angelfish", "Queen Angelfish", "Gray Angelfish", "Blue Angelfish", "Cherubfish")
# Monacanthidae = c("Orangespotted Filefish", "Slender Filefish", "Scrawled Filefish", "Whitespotted Filefish")
# Chaetodontidae = c("Spotfin Butterflyfish", "Foureye Butterflyfish", "Banded Butterflyfish", "Longsnout Butterflyfish", "Reel Butterflyfish")
CAYMAN_FISH_TIDY <- CAYMAN_FISH_TIDY %>% mutate(SCIENTIFIC_FAMILY = c("0"))
CAYMAN_FISH_TIDY <- CAYMAN_FISH_TIDY %>% mutate(SCIENTIFIC_FAMILY = case_when(
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Barred Cardinalfish", "Belted Cardinalfish", "Flamefish", "Twospot Cardinalfish", "Whitestar Cardinalfish", "Sponge Cardinalfish") ~ "Apogonidae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Blue Runner", "Bar Jack", "Horse-eye Jack", "Rainbow Runner", "Greater Amberjack", "Yellow Jack", "Almaco Jack", "Crevalle Jack", "Permit", "Black Jack", "Palometa", "Round Scad") ~ "Carangidae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Jolthead Porgy", "Sheepshead Porgy", "Saucereye Porgy", "Pluma", "Spottail Pinfish", "Sheepshead", "Silver Porgy") ~ "Sparidae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Shortstripe Goby", "Cleaning Goby", "Goldspot Goby", "Yellowline Goby", "Masked/Glass Goby", "Bridled Goby", "Neon Goby", "Colon Goby", "Blue Goby", "Spotlight Goby", "Peppermint Goby", "Yellownose Goby", "Sharknose Goby", "Pallid Goby", "Hovering Goby", "Rusty Goby", "Yellowprow Goby", "Orangesided Goby") ~ "Gobiidae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("French Grunt", "Margate (White)", "Cottonwick", "Bluestriped Grunt", "Sailors Choice", "White Grunt", "Margate (Black)", "Porkfish", "Caesar Grunt", "Striped Grunt", "Boga", "Unidentified juvenile Grunt", "Smallmouth Grunt", "Tomtate", "Bonnetmouth", "Spanish Grunt") ~ "Haemulidae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Mutton Snapper", "Schoolmaster", "Mahogany Snapper", "Yellowtail Snapper", "Lane Snapper", "Gray Snapper", "Dog Snapper", "Cubera Snapper", "Blackfin Snapper", "Glasseye Snapper") ~ "Lutjanidae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Threespot Damselfish", "Rock Beauty", "Blue Chromis", "Sergeant Major", "Longfin Damselfish", "Dusky Damselfish", "Sunshinefish", "Bicolor Damselfish", "Yellowtail Damselfish", "Brown Chromis", "Yellowtail Reeffish", "Cocoa Damselfish", "Beaugregory", "Purple Reeffish") ~ "Pomacentridae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Stoplight Parrotfish", "Redband Parrotfish", "Rainbow Parrotfish", "Princess Parrotfish", "Redtail Parrotfish", "Midnight Parrotfish", "Yellowtail (Redfin)Parrotfish", "Striped Parrotfish", "Queen Parrotfish", "Greenblotch Parrotfish", "Blue Parrotfish", "Bluelip Parrotfish", "Bucktooth Parrotfish") ~ "Scaridae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Red Hind", "Graysby", "Red Grouper", "Scamp", "Greater Soapfish", "Indigo Hamlet", "Shy Hamlet", "Barred Hamlet", "Nassau Grouper", "Black Grouper", "Butter Hamlet", "Lantern Bass", "Rock Hind", "Tiger Grouper", "Gag", "Harlequin Bass", "Coney", "Blue Hamlet", "Black Hamlet", "Yellowmouth Grouper", "Yellowtail Hamlet", "Goliath Grouper (Jewfish)", "Yellowfin Grouper", "Chalk Bass", "Yellowbelly Hamlet", "Hybrid Hamlet", "Tan Hamlet", "Belted Sandfish", "Creole-fish", "Peppermint Bass") ~ "Serranidae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Creole Wrasse", "Bluehead", "Spanish Hogfish", "Spotfin Hogfish", "Yellowhead Wrasse", "Blackear Wrasse","Puddingwife", "Hogfish", "Green Razorfish", "Slippery Dick", "Clown Wrasse", "Rainbow Wrasse", "Rosy Razorfish", "Yellowcheek Wrasse", "Pearly Razorfish") ~ "Labridae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Reef Squirrelfish", "Squirrelfish", "Longjaw Squirrelfish", "Longspine Squirrelfish", "Dusky Squirrelfish", "Blackbar Soldierfish") ~ "Holocentridae",
CAYMAN_FISH_TIDY$SPECIES_NAME %in% c("Unidentified Triplefin", "Bonefish", "Flying Gurnard", "Bluespotted Cornetfish", "Sharptail Eel", "Houndfish", "Tobaccofish", "Atlantic Spadefish", "Arrow Blenny", "Secretary Blenny", "Sailfin Blenny", "Redspotted Hawkfish", "Sharksucker", "Silversides", "Nurse Shark", "Spotted Eagle Ray", "Glassy Sweeper", "Sand Diver", "Southern Stingray", "Yellow Stingray", "Yellowhead Jawfish", "Common Snook", "Yellowfin Mojarra", "Lancer Dragonet", "Tarpon", "Sand Tilefish", "Trumpetfish", "Brown Garden Eel", "Cubbyu", "Jackknife Fish", "Highhat", "Spotted Drum", "Smooth Trunkfish", "Spotted Trunkfish", "Scrawled Cowfish", "Honeycomb Cowfish", "Blue Tang", "Doctorfish", "Ocean Surgeonfish", "Green Sea Turtle", "Hawksbill Sea Turtle", "Unidentified Sea Turtle", "Loggerhead Sea Turtle", "Diamond Blenny", "Saddled Blenny", "Rosy Blenny", "Hairy Blenny", "Green Moray", "Goldentail Moray", "Spotted Moray", "Chain Moray", "Fairy Basslet", "Blackcap Basslet", "Threeline Basslet", "Lionfish", "Spotted Scorpionfish", "Sharpnose Puffer", "Bandtail Puffer", "Chub (Bermuda/Yellow)", "Balloonfish", "Porcupinefish", "Cero", "Spanish Mackerel", "Yellow Goatfish", "Spotted Goatfish", "Great Barracuda", "Southern Sennet", "Peacock Flounder", "Eyed Flounder", "Mottled Mojarra", "Reef Croaker", "Roughhead Blenny", "Sand Perch", "Spiny Blenny", "Molly Miller", "Redlip Blenny", "Darkheaded Blenny", "Pearl Blenny", "Wrasse Bleny", "Seaweed Blenny", "Queen Triggerfish", "Black Durgon", "Ocean Triggerfish", "Gray Triggerfish", "Sargassum Triggerfish", "French Angelfish", "Queen Angelfish", "Gray Angelfish", "Blue Angelfish", "Cherubfish", "Orangespotted Filefish", "Slender Filefish", "Scrawled Filefish", "Whitespotted Filefish", "Spotfin Butterflyfish", "Foureye Butterflyfish", "Banded Butterflyfish", "Longsnout Butterflyfish", "Reel Butterflyfish", "(Other)") ~ "Other",
TRUE ~ as.character(CAYMAN_FISH_TIDY$SCIENTIFIC_FAMILY)
)) %>% dplyr::select(SPECIES_NAME, FISH_ID, SCIENTIFIC_FAMILY, YEAR, DIET, LOCATION, MARINE_RESERVE, DENSITY_INDEX)
CAYMAN_FISH_TIDY
CAYMAN_FISH_TIDY %>% filter(SPECIES_NAME %in% c("Reef Squirrelfish", "Squirrelfish", "Longjaw Squirrelfish", "Longspine Squirrelfish", "Dusky Squirrelfish", "Blackbar Soldierfish"))
CAYMAN_FISH_TIDY %>% filter(SPECIES_NAME %in% c("Threespot Damselfish", "Rock Beauty", "Blue Chromis", "Sergeant Major", "Longfin Damselfish", "Dusky Damselfish", "Sunshinefish", "Bicolor Damselfish", "Yellowtail Damselfish", "Brown Chromis", "Yellowtail Reeffish", "Cocoa Damselfish", "Beaugregory", "Purple Reeffish"))
CAYMAN_NO_ZEROS <- CAYMAN_FISH_TIDY %>% filter(DENSITY_INDEX != 0) %>% mutate(YEAR1998 = (YEAR - 1998)) %>% dplyr::select(SPECIES_NAME, FISH_ID, SCIENTIFIC_FAMILY, DIET, LOCATION, MARINE_RESERVE, DENSITY_INDEX, YEAR1998)
CAYMAN_FISH_YEARS <- CAYMAN_FISH_TIDY %>% mutate(YEAR1998 = (YEAR - 1998)) %>% dplyr::select(SPECIES_NAME, SCIENTIFIC_FAMILY, DIET, LOCATION, MARINE_RESERVE, DENSITY_INDEX, YEAR1998)
sum(CAYMAN_FISH_TIDY$DENSITY_INDEX == 0)
sum(CAYMAN_FISH_TIDY$DENSITY_INDEX == 1)
sum(CAYMAN_FISH_TIDY$DENSITY_INDEX == 2)
sum(CAYMAN_FISH_TIDY$DENSITY_INDEX == 3)
Whole_Numbers <- 16844+1348+1533+411
Non_Whole_Numbers <- 22052 -(16844+1348+1533+411)
# Very Right Skewed/Abnormal Distribution
ALL_DENSITY <- ggplot(CAYMAN_FISH_TIDY, aes(x = DENSITY_INDEX))+
geom_density(alpha = 0.8, fill = "blue", color = "magenta")+
xlab("DENSITY INDEX")+
ylab("Frequency")+
labs(title = "Density Index Distribution for All Observations")
DENSITY_NOZEROS <- ggplot(CAYMAN_NO_ZEROS, aes(x = DENSITY_INDEX))+
geom_density(alpha = 0.8, fill = "blue", color = "magenta")+
xlab("DENSITY INDEX")+
ylab("Frequency")+
labs(title = "Density Index Distribution for Non-Zero Observations")
grid.arrange(ALL_DENSITY, DENSITY_NOZEROS, ncol=1)
#### Zero Violins
VIOLIN_LOCATION <- ggplot(data=CAYMAN_FISH_TIDY, aes(x=LOCATION, y=DENSITY_INDEX, fill=LOCATION, color=LOCATION)) +
geom_violin(alpha=0.2) + xlab("Location") + ylab("Density Index Value") + ggtitle("Density Index Values by Dive Locations") + stat_summary(fun.y=mean, geom="point", shape=23, size=4)
VIOLIN_RESERVE <- ggplot(data=CAYMAN_FISH_TIDY, aes(x=MARINE_RESERVE, y=DENSITY_INDEX, fill=MARINE_RESERVE, color=MARINE_RESERVE)) +
geom_violin(alpha=0.2) + xlab("Marine Reserve Site (Yes or No)") + ylab("Density Index Value") + ggtitle("Density Index Values for Sites Within VS Outside of Marine Reserves") + stat_summary(fun.y=mean, geom="point", shape=20, size=4)
VIOLIN_DIET <- ggplot(data=CAYMAN_FISH_TIDY, aes(x=DIET, y= DENSITY_INDEX, fill=DIET, color=DIET)) +
geom_violin(alpha=0.2) + xlab("Diet") + ylab("Density Index Value") + ggtitle("Density Index Values by Primary Species Diets") + stat_summary(fun.y=mean, geom="point", shape=12, size=4)
VIOLIN_FAMILY <- ggplot(data=CAYMAN_FISH_TIDY, aes(x=SCIENTIFIC_FAMILY, y=DENSITY_INDEX, fill=SCIENTIFIC_FAMILY, color=SCIENTIFIC_FAMILY)) +
geom_violin(alpha=0.2) + xlab("Scientific Family") + ylab("Density Index Value") + ggtitle("Density Index Values by Fish Scientific Families") + stat_summary(fun.y=mean, geom="point", shape=15, size=4)
grid.arrange(VIOLIN_LOCATION, VIOLIN_RESERVE, ncol = 1)
grid.arrange(VIOLIN_DIET, VIOLIN_FAMILY, ncol = 1)
### NON-ZERO VIOLINS
NOZERO_VIOLIN_LOCATION <- ggplot(data=CAYMAN_NO_ZEROS, aes(x=LOCATION, y=DENSITY_INDEX, fill=LOCATION, color=LOCATION)) +
geom_violin(alpha=0.2) + xlab("Location") + ylab("Density Index Value") + ggtitle("Non-Zero Density Index Values by Dive Locations") + stat_summary(fun.y=mean, geom="point", shape=23, size=4)
NOZERO_VIOLIN_RESERVE <- ggplot(data=CAYMAN_NO_ZEROS, aes(x=MARINE_RESERVE, y=DENSITY_INDEX, fill=MARINE_RESERVE, color=MARINE_RESERVE)) +
geom_violin(alpha=0.2) + xlab("Marine Reserve Site (Yes or No)") + ylab("Density Index Value") + ggtitle("Non-Zero Density Index Values for Sites Within VS Outside of Marine Reserves") + stat_summary(fun.y=mean, geom="point", shape=20, size=4)
NOZERO_VIOLIN_DIET <- ggplot(data=CAYMAN_NO_ZEROS, aes(x=DIET, y= DENSITY_INDEX, fill=DIET, color=DIET)) +
geom_violin(alpha=0.2) + xlab("Diet") + ylab("Density Index Value") + ggtitle("Non-Zero Density Index Values by Primary Species Diets") + stat_summary(fun.y=mean, geom="point", shape=12, size=4)
NOZERO_VIOLIN_FAMILY <- ggplot(data=CAYMAN_NO_ZEROS, aes(x=SCIENTIFIC_FAMILY, y=DENSITY_INDEX, fill=SCIENTIFIC_FAMILY, color=SCIENTIFIC_FAMILY)) +
geom_violin(alpha=0.2) + xlab("Scientific Family") + ylab("Density Index Value") + ggtitle("Non-Zero Density Index Values by Fish Scientific Families") + stat_summary(fun.y=mean, geom="point", shape=15, size=4)
grid.arrange(NOZERO_VIOLIN_LOCATION, NOZERO_VIOLIN_RESERVE, ncol = 1)
grid.arrange(NOZERO_VIOLIN_DIET, NOZERO_VIOLIN_FAMILY, ncol = 1)
### LATTICE PLOTS
All.Lattice.location <- ggplot(data = CAYMAN_FISH_YEARS, aes(x = YEAR1998, y = DENSITY_INDEX))+
geom_point(color = "blue")+
stat_smooth(method = "lm", color ="firebrick1", se = F)+
facet_wrap(~LOCATION)+
xlab("Time Since 1998")+
ylab("Density Index Scores")+
labs(title = "All Density Index Scores by Location")
NoZero.Lattice.location <- ggplot(data = CAYMAN_NO_ZEROS, aes(x = YEAR1998, y = DENSITY_INDEX))+
geom_point(color = "blue")+
stat_smooth(method = "lm", color ="firebrick1", se = F)+
facet_wrap(~LOCATION)+
xlab("Time Since 1998")+
ylab("Density Index Scores")+
labs(title = "Non-Zero Density Index Scores by Location")
All.Lattice.Reserve <- ggplot(data = CAYMAN_FISH_YEARS, aes(x = YEAR1998, y = DENSITY_INDEX))+
geom_point(color = "blue")+
stat_smooth(method = "lm", color ="firebrick1", se = F)+
facet_wrap(~MARINE_RESERVE)+
xlab("Time Since 1998")+
ylab("Density Index Scores")+
labs(title = "Non-Zero Density Index Scores for Marine Reserve Vs. Non-Reserve Sites")
NoZero.Lattice.Reserve <- ggplot(data = CAYMAN_NO_ZEROS, aes(x = YEAR1998, y = DENSITY_INDEX))+
geom_point(color = "blue")+
stat_smooth(method = "lm", color ="firebrick1", se = F)+
facet_wrap(~MARINE_RESERVE)+
xlab("Time Since 1998")+
ylab("Density Index Scores")+
labs(title = "All Density Index Scores for Marine Reserve Vs. Non-Reserve Sites")
grid.arrange(All.Lattice.location, All.Lattice.Reserve, NoZero.Lattice.location, NoZero.Lattice.Reserve, ncol = 2)
All.Lattice.Diet <- ggplot(data = CAYMAN_FISH_YEARS, aes(x = YEAR1998, y = DENSITY_INDEX))+
geom_point(color = "blue")+
stat_smooth(method = "lm", color ="firebrick1", se = F)+
facet_wrap(~DIET)+
xlab("Time Since 1998")+
ylab("Density Index Scores")+
labs(title = "All Density Index Scores by Diet")
NoZero.Lattice.Diet <- ggplot(data = CAYMAN_NO_ZEROS, aes(x = YEAR1998, y = DENSITY_INDEX))+
geom_point(color = "blue")+
stat_smooth(method = "lm", color ="firebrick1", se = F)+
facet_wrap(~DIET)+
xlab("Time Since 1998")+
ylab("Density Index Scores")+
labs(title = "Non-Zero Density Index Scores by Diet")
All.Lattice.Family <- ggplot(data = CAYMAN_FISH_YEARS, aes(x = YEAR1998, y = DENSITY_INDEX))+
geom_point(color = "blue")+
stat_smooth(method = "lm", color ="firebrick1", se = F)+
facet_wrap(~SCIENTIFIC_FAMILY)+
xlab("Time Since 1998")+
ylab("Density Index Scores")+
labs(title = "All Density Index Scores by Scientific Family")
NoZero.Lattice.Family <- ggplot(data = CAYMAN_NO_ZEROS, aes(x = YEAR1998, y = DENSITY_INDEX))+
geom_point(color = "blue")+
stat_smooth(method = "lm", color ="firebrick1", se = F)+
facet_wrap(~SCIENTIFIC_FAMILY)+
xlab("Time Since 1998")+
ylab("Density Index Scores")+
labs(title = "Non-Zero Density Index Scores by Scientific Family")
grid.arrange(All.Lattice.Diet, All.Lattice.Family, NoZero.Lattice.Diet, NoZero.Lattice.Family, ncol = 2)
All.lattice.Year <- ggplot(data = CAYMAN_FISH_YEARS, aes(x = YEAR1998, y = DENSITY_INDEX))+
geom_point(color = "blue")+
stat_smooth(method = "lm", color ="firebrick1", se = F)+
xlab("Time Since 1998")+
ylab("Density Index Scores")+
labs(title = "All Density Index Scores Over Time")
NoZero.Lattice.Year <- ggplot(data = CAYMAN_NO_ZEROS, aes(x = YEAR1998, y = DENSITY_INDEX))+
geom_point(color = "blue")+
stat_smooth(method = "lm", color ="firebrick1", se = F)+
xlab("Time Since 1998")+
ylab("Density Index Scores")+
labs(title = "Non-Zero Desnity Index Scores Over Time")
grid.arrange(All.lattice.Year, NoZero.Lattice.Year)
### LOCATION SUMMARY
ALL_CAYMAN_FISH_LOCATION <- CAYMAN_FISH_TIDY %>% group_by(LOCATION) %>% dplyr::summarize(MEAN = mean(DENSITY_INDEX), ST.DEV = sd(DENSITY_INDEX), ST.ERR = sd(DENSITY_INDEX)/sqrt(n()), N = n())
NOZERO_CAYMAN_FISH_LOCATION <- CAYMAN_NO_ZEROS %>% group_by(LOCATION) %>% dplyr::summarize(MEAN = mean(DENSITY_INDEX), ST.DEV = sd(DENSITY_INDEX), ST.ERR = sd(DENSITY_INDEX)/sqrt(n()), N = n())
### MARINE RESERVE SUMMARY
ALL_CAYMAN_FISH_RESERVE <- CAYMAN_FISH_TIDY %>% group_by(MARINE_RESERVE) %>% dplyr::summarize(MEAN = mean(DENSITY_INDEX), ST.DEV = sd(DENSITY_INDEX), ST.ERR = sd(DENSITY_INDEX)/sqrt(n()), N = n())
NOZERO_CAYMAN_FISH_RESERVE <- CAYMAN_NO_ZEROS %>% group_by(MARINE_RESERVE) %>% dplyr::summarize(MEAN = mean(DENSITY_INDEX), ST.DEV = sd(DENSITY_INDEX), ST.ERR = sd(DENSITY_INDEX)/sqrt(n()), N = n())
### DIET SUMMARY
ALL_CAYMAN_FISH_DIET <- CAYMAN_FISH_TIDY %>% group_by(DIET) %>% dplyr::summarize(MEAN = mean(DENSITY_INDEX), ST.DEV = sd(DENSITY_INDEX), ST.ERR = sd(DENSITY_INDEX)/sqrt(n()), N = n())
NOZERO_CAYMAN_FISH_DIET <- CAYMAN_NO_ZEROS %>% group_by(DIET) %>% dplyr::summarize(MEAN = mean(DENSITY_INDEX), ST.DEV = sd(DENSITY_INDEX), ST.ERR = sd(DENSITY_INDEX)/sqrt(n()), N = n())
### FAMILY SUMMARY
ALL_CAYMAN_FISH_FAMILY <- CAYMAN_FISH_TIDY %>% group_by(SCIENTIFIC_FAMILY) %>% dplyr::summarize(MEAN = mean(DENSITY_INDEX), ST.DEV = sd(DENSITY_INDEX), ST.ERR = sd(DENSITY_INDEX)/sqrt(n()), N = n())
NOZERO_CAYMAN_FISH_FAMILY <- CAYMAN_NO_ZEROS %>% group_by(SCIENTIFIC_FAMILY) %>% dplyr::summarize(MEAN = mean(DENSITY_INDEX), ST.DEV = sd(DENSITY_INDEX), ST.ERR = sd(DENSITY_INDEX)/sqrt(n()), N = n())
### OVERALL
ALL_CAYMAN_FISH_OVERALL <- CAYMAN_FISH_TIDY %>% dplyr::summarize(MEAN = mean(DENSITY_INDEX), ST.DEV = sd(DENSITY_INDEX), ST.ERR = sd(DENSITY_INDEX)/sqrt(n()), N = n())
NOZERO_CAYMAN_FISH_OVERALL <- CAYMAN_NO_ZEROS %>% dplyr::summarize(MEAN = mean(DENSITY_INDEX), ST.DEV = sd(DENSITY_INDEX), ST.ERR = sd(DENSITY_INDEX)/sqrt(n()), N = n())
### Summary Tables ALL
kable(ALL_CAYMAN_FISH_LOCATION, booktabs = T,
caption = "Overall Summary Statistics for Eleven Dive Sites on Grand Cayman Island",
col.names = c("Location", "Mean Density Index", "Standard Deviation", "Standard Error", "Sample Size")) %>%
kable_styling(full_width = T)
kable(ALL_CAYMAN_FISH_RESERVE, booktabs = T,
caption = "Overall Summary Statistics for Marine Reserve VS Non-Reserve Sites on Grand Cayman Island",
col.names = c("Reserve Type", "Mean Density Index", "Standard Deviation", "Standard Error", "Sample Size")) %>%
kable_styling(full_width = T)
kable(ALL_CAYMAN_FISH_DIET, booktabs = T,
caption = "Overall Summary Statistics for Species Primary Diets on Grand Cayman Island",
col.names = c("Diet", "Mean Density Index", "Standard Deviation", "Standard Error", "Sample Size")) %>%
kable_styling(full_width = T)
kable(ALL_CAYMAN_FISH_FAMILY, booktabs = T,
caption = "Overall Summary Statistics Across Scientific Families on Grand Cayman Island",
col.names = c("Family", "Mean Density Index", "Standard Deviation", "Standard Error", "Sample Size")) %>%
kable_styling(full_width = T)
kable(ALL_CAYMAN_FISH_OVERALL, booktabs = T,
caption = "Overall Summary Statistics of Density Index on Grand Cayman Island",
col.names = c("Mean Density Index", "Standard Deviation", "Standard Error", "Sample Size")) %>%
kable_styling(full_width = T)
### No Zeros Summaries
kable(NOZERO_CAYMAN_FISH_LOCATION, booktabs = T,
caption = "Non-Zero Summary Statistics for Eleven Dive Sites on Grand Cayman Island",
col.names = c("Location", "Mean Density Index", "Standard Deviation", "Standard Error", "Sample Size")) %>%
kable_styling(full_width = T)
kable(NOZERO_CAYMAN_FISH_RESERVE, booktabs = T,
caption = "Non-Zero Summary Statistics for Marine Reserve VS Non-Reserve Sites on Grand Cayman Island",
col.names = c("Reserve Type", "Mean Density Index", "Standard Deviation", "Standard Error", "Sample Size")) %>%
kable_styling(full_width = T)
kable(NOZERO_CAYMAN_FISH_DIET, booktabs = T,
caption = "Non-Zero Summary Statistics for Species Primary Diets on Grand Cayman Island",
col.names = c("Diet", "Mean Density Index", "Standard Deviation", "Standard Error", "Sample Size")) %>%
kable_styling(full_width = T)
kable(NOZERO_CAYMAN_FISH_FAMILY, booktabs = T,
caption = "Non-Zero Summary Statistics Across Scientific Families on Grand Cayman Island",
col.names = c("Family", "Mean Density Index", "Standard Deviation", "Standard Error", "Sample Size")) %>%
kable_styling(full_width = T)
kable(NOZERO_CAYMAN_FISH_OVERALL, booktabs = T,
caption = "Non-Zero Summary Statistics of Density Index on Grand Cayman Island",
col.names = c("Mean Density Index", "Standard Deviation", "Standard Error", "Sample Size")) %>%
kable_styling(full_width = T)
### Hypothesis Tests
# Assumptions of Parametric Statistics:
# INDEPENDENCE:
# Fair to assume samples were independent as they occur across different years and sites. Unlikely they were the same fish surveyed.
# NORMALITY
# Central Limit Theorum Says that any distribution of n>30 sample size is approximately normal!
# EQUAL VARIANCE
########## Zero-Inclusive
# Null Hypothesis: Variances are approximately equal
# Alternative Hypothesis: Variances are unequal
All_Levene_Location <- leveneTest(DENSITY_INDEX ~ LOCATION, data= CAYMAN_FISH_TIDY)
All_Levene_Reserve <- leveneTest(DENSITY_INDEX ~ MARINE_RESERVE, data= CAYMAN_FISH_TIDY)
All_Levene_Diet <- leveneTest(DENSITY_INDEX ~ DIET, data= CAYMAN_FISH_TIDY)
All_Levene_Family <- leveneTest(DENSITY_INDEX ~ SCIENTIFIC_FAMILY, data= CAYMAN_FISH_TIDY)
All_Levene_Location
All_Levene_Reserve
All_Levene_Diet
All_Levene_Family
All_Levene_Test <- c("Diet", "Family", "Location", "Reserve")
All_Levene_PVals <- c(0.00000000000000022, 0.00000000000000022, 0.00000000002151, 0.0008255)
All_Levene_Interpret <- c("Unequal Variance", "Unequal Variance", "Unequal Variance", "Unequal Variance")
All_Levene_Results <- as.data.frame(cbind(All_Levene_Test, All_Levene_PVals, All_Levene_Interpret))
# Non-Zero Levene
NoZero_Levene_Location <- leveneTest(DENSITY_INDEX ~ LOCATION, data= CAYMAN_NO_ZEROS)
NoZero_Levene_Reserve <- leveneTest(DENSITY_INDEX ~ MARINE_RESERVE, data= CAYMAN_NO_ZEROS)
NoZero_Levene_Diet <- leveneTest(DENSITY_INDEX ~ DIET, data= CAYMAN_NO_ZEROS)
NoZero_Levene_Family <- leveneTest(DENSITY_INDEX ~ SCIENTIFIC_FAMILY, data= CAYMAN_NO_ZEROS)
NoZero_Levene_Location
NoZero_Levene_Reserve
NoZero_Levene_Diet
NoZero_Levene_Family
NoZero_Levene_Test <- c("Diet", "Family", "Location", "Reserve")
NoZero_Levene_PVals <- c(0.000000000008094, 0.00000000000000022, 0.6516, 0.0636)
NoZero_Levene_Interpret <- c("Unequal Variance", "Unequal Variance", "Equal Variance", "Equal Variance")
NoZero_Levene_Results <- as.data.frame(cbind(NoZero_Levene_Test, NoZero_Levene_PVals, NoZero_Levene_Interpret))
NoZero_Levene_Results
### Levene Kable Results
# Zero-Inclusive
kable(All_Levene_Results, booktabs = T,
caption = "Summary of Levene Test Results",
col.names = c("Test Variable", "Resulting P-Value", "Interpretation")) %>%
kable_styling(full_width = T)
# Non-Zero
kable(NoZero_Levene_Results, booktabs = T,
caption = "Non-Zero Data Summary of Levene Test Results",
col.names = c("Test Variable", "Resulting P-Value", "Interpretation")) %>%
kable_styling(full_width = T)
### ANOVA and T-Test
# Null Hypothesis: Means are approximately equal
# Alternative Hypothesis: Means are different
All_ANOVA_Location <- oneway.test(DENSITY_INDEX ~ LOCATION, data= CAYMAN_FISH_TIDY)
All_T_Reserve <- t.test(DENSITY_INDEX ~ MARINE_RESERVE, data= CAYMAN_FISH_TIDY)
All_ANOVA_Diet <- oneway.test(DENSITY_INDEX ~ DIET, data= CAYMAN_FISH_TIDY)
All_ANOVA_Family <- oneway.test(DENSITY_INDEX ~ SCIENTIFIC_FAMILY, data= CAYMAN_FISH_TIDY)
All_ANOVA_Location
All_T_Reserve
All_ANOVA_Diet
All_ANOVA_Family
All_TANOVA_Test <- c("Diet", "Family", "Location", "Reserve")
All_Test_Type <- c("Welch ANOVA", "Welch ANOVA", "Welch ANOVA", "Welch T-Test")
All_TANOVA_PVals <- c(0.00000000000000022, 0.00000000000000022, 0.000000000001144, 0.0007742)
All_Result_Interpret <- c("True Mean Difference Not 0", "True Mean Difference Not 0", "True Mean Difference Not 0", "True Mean Difference Not 0")
All_TANOVA_Results <- as.data.frame(cbind(All_TANOVA_Test, All_Test_Type, All_TANOVA_PVals, All_Result_Interpret))
# Non-Zero Levene
NoZero_ANOVA_Location <- aov(DENSITY_INDEX ~ LOCATION, data= CAYMAN_NO_ZEROS)
NoZero_T_Reserve <- t.test(DENSITY_INDEX ~ MARINE_RESERVE, data= CAYMAN_NO_ZEROS, var.equal = T)
NoZero_ANOVA_Diet <- oneway.test(DENSITY_INDEX ~ DIET, data= CAYMAN_NO_ZEROS)
NoZero_ANOVA_Family <- oneway.test(DENSITY_INDEX ~ SCIENTIFIC_FAMILY, data= CAYMAN_NO_ZEROS)
summary(NoZero_ANOVA_Location)
NoZero_T_Reserve
NoZero_ANOVA_Diet
NoZero_ANOVA_Family
NoZero_TANOVA_Test <- c("Diet", "Family", "Location", "Reserve")
NoZero_Test_Type <- c("Welch ANOVA", "Welch ANOVA", "Standard ANOVA", "Equal Variance T-Test")
NoZero_TANOVA_PVals <- c(0.00000000000000022, 0.00000000000000022, 0.317, 0.5413)
NoZero_Result_Interpret <- c("True Mean Difference Not 0", "True Mean Difference Not 0", "True Mean Difference = 0", "True Mean Difference = 0")
NoZero_TANOVA_Results <- as.data.frame(cbind(NoZero_TANOVA_Test, NoZero_Test_Type, NoZero_TANOVA_PVals, NoZero_Result_Interpret))
NoZero_TANOVA_Results
### TANOVA Kable Results
# Zero-Inclusive
kable(All_TANOVA_Results, booktabs = T,
caption = "Summary of ANOVA and T-Test Results",
col.names = c("Test Variable", "Test Type", "Resulting P-Value", "Interpretation")) %>%
kable_styling(full_width = T)
# Non-Zero
kable(NoZero_TANOVA_Results, booktabs = T,
caption = "Non-Zero Data Summary of ANOVA and T-Test Results",
col.names = c("Test Variable", "Test Type", "Resulting P-Value", "Interpretation")) %>%
kable_styling(full_width = T)
### Year as a random slope?
CAYMAN_NO_ZEROS <- CAYMAN_NO_ZEROS %>% dplyr::select(DENSITY_INDEX, FISH_ID, SPECIES_NAME, SCIENTIFIC_FAMILY, DIET, LOCATION, MARINE_RESERVE, YEAR1998)
SPECIES_SUBSET <- CAYMAN_NO_ZEROS[1:530, ]
# Individual Species Plot
ggplot(SPECIES_SUBSET, aes(x = YEAR1998, y = DENSITY_INDEX))+
geom_point(color = "blue")+
facet_wrap(~SPECIES_NAME, ncol = 4)+
geom_smooth(aes(group = 1), color = "firebrick1", size = 1, se = F)+
labs(x = "Years since 1998", y = "Density Index")+
ylim(0,4)
# Overall Slopes Plot
ggplot(CAYMAN_NO_ZEROS, aes(x = YEAR1998, y = DENSITY_INDEX))+
geom_line(aes(group = FISH_ID), color = "grey")+
facet_wrap(~LOCATION)+
geom_smooth(aes(group = 1), color = "blue", size = 1)+
labs(x = "Years since 1998", y = "Density Index", title = "                                                               Average Density Index Slope Across All Years and Observations by
Compared Against Density Index Slopes For Individual Species Across All Years")+
ylim(0,4)
### Check for interaction
interaction.nozero.cayman.diet <- ggplot(CAYMAN_NO_ZEROS, aes(x = YEAR1998, y = DENSITY_INDEX, colour = DIET)) + geom_point() + geom_smooth(aes(linetype = DIET), method = lm, se = FALSE) + ylab("Density Index Scores") + xlab("Year of Data Collection")
interaction.nozero.cayman.diet
interaction.nozero.cayman.location <- ggplot(CAYMAN_NO_ZEROS, aes(x = YEAR1998, y = DENSITY_INDEX, colour = LOCATION)) + geom_point() + geom_smooth(aes(linetype = LOCATION), method = lm, se = FALSE) + ylab("Density Index Scores") + xlab("Year of Data Collection")
interaction.nozero.cayman.location
interaction.nozero.cayman.reserve <- ggplot(CAYMAN_NO_ZEROS, aes(x = YEAR1998, y = DENSITY_INDEX, colour = MARINE_RESERVE)) + geom_point() + geom_smooth(aes(linetype = MARINE_RESERVE), method = lm, se = FALSE) + ylab("Density Index Scores") + xlab("Year of Data Collection")
interaction.nozero.cayman.reserve
interaction.nozero.cayman.family <- ggplot(CAYMAN_NO_ZEROS, aes(x = YEAR1998, y = DENSITY_INDEX, colour = SCIENTIFIC_FAMILY)) + geom_point() + geom_smooth(aes(linetype = SCIENTIFIC_FAMILY), method = lm, se = FALSE) + ylab("Density Index Scores") + xlab("Year of Data Collection")
interaction.nozero.cayman.family
grid.arrange(interaction.nozero.cayman.family, interaction.nozero.cayman.diet, ncol = 2)
summary(Unconditional_Growth)
Unconditional_Growth <- lmer(DENSITY_INDEX ~ YEAR1998 + (YEAR1998|SPECIES_NAME), REML = T, data = CAYMAN_NO_ZEROS)
summary(Unconditional_Growth)
Unconditional_Mean <- lmer(DENSITY_INDEX ~ 1 + (1|SPECIES_NAME), REML = T, data = CAYMAN_NO_ZEROS)
summary(Unconditional_Mean)
summary(M4_LMER)
M4_LMER <- lmer(DENSITY_INDEX ~ YEAR1998 + DIET + SCIENTIFIC_FAMILY + YEAR1998*SCIENTIFIC_FAMILY + (1|SPECIES_NAME), REML = T, data = CAYMAN_NO_ZEROS)
summary(M4_LMER)
summary(M5_LMER)
M5_LMER <- lmer(DENSITY_INDEX ~ YEAR1998 + DIET + SCIENTIFIC_FAMILY + YEAR1998*SCIENTIFIC_FAMILY + (YEAR1998|SPECIES_NAME), REML = T, data = CAYMAN_NO_ZEROS)
summary(M5_LMER)
summary(FINAL_LOGI_CAYMAN)
Family_Name <- c("Apogonidae", "Carangidae", "Gobiidae", "Sparidae", "Haemulidae", "Holocentridae", "Labridae", "Lutjanidae", "Pomacentridae", "Scaridae", "Serranidae", "Other")
Probability_NonZero <- c("0.102 (10.2%)", "0.102 (10.2%)", "0.102 (10.2%)", "0.102 (10.2%)", "0.169 (16.9%)", "0.510 (51.0%)", "0.264 (26.4%)", "0.311 (31.1%)", "0.499 (49.9%)", "0.356 (35.6%)", "0.197 (19.7%)", "0.238 (23.8%)")
Model_Pval <- c("2e-16", "0.683", "0.266", "0.351", "0.000229", "2e-16", "9.14e-14", "2e-16", "1.86e-12", "2e-16", "2e-16", "2.71e-7")
LogiFamily_Name <- c("Apogonidae", "Carangidae", "Gobiidae", "Sparidae", "Haemulidae", "Holocentridae", "Labridae", "Lutjanidae", "Pomacentridae", "Scaridae", "Serranidae", "Other")
LogiModel_Pval <- c("2e-16", "0.683", "0.266", "0.351", "0.000229", "2e-16", "9.14e-14", "2e-16", "1.86e-12", "2e-16", "2e-16", "2.71e-7")
LOGISTIC_INTERPRETATIONS <- as.data.frame(cbind(LogiFamily_Name, LogiModel_Pval, LogiProbability_NonZero))
LogiProbability_NonZero <- c("0.102 (10.2%)", "0.102 (10.2%)", "0.102 (10.2%)", "0.102 (10.2%)", "0.169 (16.9%)", "0.510 (51.0%)", "0.264 (26.4%)", "0.311 (31.1%)", "0.499 (49.9%)", "0.356 (35.6%)", "0.197 (19.7%)", "0.238 (23.8%)")
LOGISTIC_INTERPRETATIONS <- as.data.frame(cbind(LogiFamily_Name, LogiModel_Pval, LogiProbability_NonZero))
kable(LOGISTIC_INTERPRETATIONS, booktabs = T,
caption = "Logistic Regression Probabilities of Non-Zero Observations By Families",
col.names = c("Family", "Model P-Value", "Probability Non-Zero")) %>%
kable_styling(full_width = T)
